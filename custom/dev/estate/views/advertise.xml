<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="res_users_view_form" model="ir.ui.view">
        <field name="name">res.users.view.form.inherit.estate.property</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_form"/>
        <field name="arch" type="xml">
            <notebook>
                <page string="Real Estate Property">
                    <tree>
                        <field name="property_ids"/>
                    </tree>
                </page>
            </notebook>

        </field>
    </record>

    <record id="property_house_view_form" model="ir.ui.view">
        <field name="name">estate.property.form</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_do_sold" type="object" string="Sold" invisible="state in ('Sold', 'Canceled')" />
                    <button name="action_do_cancel" type="object" string="Cancel" invisible="state in ('Sold', 'Canceled')"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <group>
                        <field name="name" data-oe-type="char" data-oe-translatable="1"/>
                        <field name="tag_ids" widget='many2many_tags' options="{'color_field': 'color'}"/>

                        <field name="property_type_id" widget="selection_badge" options="{'no_create': True}"/>
                        <field name="active"/>


                    </group>
                    <group>
                        <field name="expected_price"/>
                        <field name="Pool_house"/>
                        <field name="best_offer"/>

                    </group>
                    <notebook>
                        <page string="Description">
                            <group>
                                <field name="date_time"/>
                                <field name="selling_price"/>
                                <field name="bed_room"/>
                                <field name="living_area"/>
                                <field name="total_area"/>
                                <field name="garden_is_check"/>
                                <field name="garden_area" invisible="not garden_is_check"/>
                                <field name="garden_oriented" invisible="not garden_is_check"/>
                            </group>
                        </page>
                        <page string="Other">
                            <group>
                                <field name="partner_id"/>
                                <field name="users_id"/>
                            </group>
                        </page>
                        <page string="Offer">
                            <!--                               # Do not allow adding an offer when the property state is ‘Offer Accepted’, ‘Sold’ or ‘Canceled’..-->
                            <!--                            <field name="offer_ids" readonly="state in ('Sold', 'Canceled', 'Offer Accepted', 'Offer Received')">-->
                            <field name="offer_ids" >
                                <tree editable="bottom" decoration-danger="offer_status == 'Refused'"
                                      decoration-success="offer_status == 'Accepted'">
                                    <field name="offer_property_type_id"/>
                                    <field name="offer_price" />
                                    <field name="Offer_partner_id" />
                                    <field name="offer_status" invisible="1" optional="hide" />
                                    <button name="Price_offer_accept" string=" " states="draft" type="object" icon="fa-check" invisible="offer_status in ('Refused', 'Accepted')"/>
                                    <button name="Price_offer_refuse" string=" " states="draft" type="object" icon="fa-times" invisible="offer_status in ('Refused', 'Accepted')"/>
                                    <field name="validity"/>
                                    <field name="date_deadline"/>
                                </tree>
                                <form>
                                    <group>
                                        <field name="offer_price"/>
                                        <field name="Offer_partner_id"/>
                                        <field name="offer_status"/>
                                        <field name="validity"/>
                                        <field name="date_deadline"/>

                                    </group>
                                </form>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="property_house_view_tree" model="ir.ui.view">
        <field name="name">estate.property.tree</field>
        <field name="model">estate.property</field>

        <field name="arch" type="xml">
            <tree default_order="create_date desc"
                  decoration-success="state in ('Offer Received','Offer Accepted') "
                  decoration-bf="state=='Offer Accepted'"
                  decoration-muted="state=='Sold'">
                <field name="name"/>
                <field name="Pool_house"/>
                <field name="bed_room"/>
                <field name="tag_ids" widget='many2many_tags' />
                <field name="expected_price"/>
                <field name="garden_oriented"/>
                <field name="date_time" optional="hide"/>
                <field name="selling_price"/>
                <field name="active"/>
                <field name="state" />
            </tree>
        </field>
    </record>

    <record id="property_house_view_kanban" model="ir.ui.view">
        <field name="name">estate.property.kanban</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
            <kanban default_group_by = 'property_type_id'>
                <field name="state"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click">
                            <div>
                                <strong>Name: </strong><field name="name"/>
                            </div>
                            <div>
                                <strong>State: </strong><field name="state"/>
                            </div>
                            <div t-if="record.state.raw_value == 'Offer Received'">
                                <strong>Best Offer: </strong><field name="best_offer"/>
                            </div>
                            <div t-if="record.state.raw_value == 'Offer Accepted'">
                                <strong>Selling price: </strong><field name="selling_price"/>
                            </div>
                            <div>
                                <field name="tag_ids" options="{'color_field': 'color'}"/>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>


    <record id="property_house_view_search" model="ir.ui.view">
        <field name="name">estate.property.search</field>
        <field name="model">estate.property</field>
        <field name="arch" type="xml">
            <search string="Picking Lists">

                <filter name="available_date" string="Available Date" domain="[('date_time', '&lt;', current_date),  ('state', 'in', ('New', 'Offer Received'))]"/>
                <!--                        domain="[('my_activity_date_deadline', '&lt;', context_today().strftime('%Y-%m-%d'))]-->
                <field name="living_area" string="Living Area" filter_domain="[('living_area', '>=', self)]"/>
            </search>
        </field>
    </record>




    <record id="action_partner_estate" model="ir.actions.act_window">
        <field name="name">Advertise</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">estate.property</field>
        <field name="view_mode">tree,form,kanban</field>
        <field name="context">{'search_default_available_date': 1}</field>
    </record>


    <menuitem id="menu_estate_advertise"
              name="Advertise"
              parent="menu_estate_property"
              action="action_partner_estate"
              sequence="10"/>


</odoo>